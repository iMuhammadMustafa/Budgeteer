// Mock Transactions.Repository for demo mode

import { useQuery, useMutation, useInfiniteQuery } from "@tanstack/react-query";
import { Transaction, TransactionsView } from "@/src/types/db/Tables.Types";
import { TransactionFilters } from "@/src/types/apis/TransactionFilters";

// Example mock data
const mockTransactions: Transaction[] = [
  {
    id: "tr-1",
    accountid: "acc-1",
    amount: 50,
    categoryid: "tc-1",
    createdat: "2025-01-01T10:00:00Z",
    createdby: "0742f34e-7c12-408a-91a2-ed95d355bc87",
    date: "2025-01-01T10:00:00Z",
    description: "Grocery shopping",
    isdeleted: false,
    isvoid: false,
    name: "Groceries",
    notes: "Bought fruits and vegetables",
    payee: "Supermarket",
    tags: ["food"],
    tenantid: "0742f34e-7c12-408a-91a2-ed95d355bc87",
    transferaccountid: null,
    transferid: null,
    type: "Expense",
    updatedat: null,
    updatedby: null,
  },
  {
    id: "tr-2",
    accountid: "acc-2",
    amount: 3000,
    categoryid: "tc-2",
    createdat: "2025-01-02T10:00:00Z",
    createdby: "0742f34e-7c12-408a-91a2-ed95d355bc87",
    date: "2025-01-02T10:00:00Z",
    description: "Salary for January",
    isdeleted: false,
    isvoid: false,
    name: "Salary",
    notes: null,
    payee: "Company",
    tags: ["income"],
    tenantid: "0742f34e-7c12-408a-91a2-ed95d355bc87",
    transferaccountid: null,
    transferid: null,
    type: "Income",
    updatedat: null,
    updatedby: null,
  },
  {
    id: "tr-3",
    accountid: "acc-3",
    amount: 100,
    categoryid: "tc-3",
    createdat: "2025-01-03T10:00:00Z",
    createdby: "0742f34e-7c12-408a-91a2-ed95d355bc87",
    date: "2025-01-03T10:00:00Z",
    description: "Dinner at restaurant",
    isdeleted: false,
    isvoid: false,
    name: "Dining Out",
    notes: null,
    payee: "Pizza Place",
    tags: ["food", "leisure"],
    tenantid: "0742f34e-7c12-408a-91a2-ed95d355bc87",
    transferaccountid: null,
    transferid: null,
    type: "Expense",
    updatedat: null,
    updatedby: null,
  },
  {
    id: "tr-4",
    accountid: "acc-4",
    amount: 200,
    categoryid: "tc-4",
    createdat: "2025-01-04T10:00:00Z",
    createdby: "0742f34e-7c12-408a-91a2-ed95d355bc87",
    date: "2025-01-04T10:00:00Z",
    description: "Electricity bill",
    isdeleted: false,
    isvoid: false,
    name: "Electricity",
    notes: null,
    payee: "Utility Company",
    tags: ["utilities"],
    tenantid: "0742f34e-7c12-408a-91a2-ed95d355bc87",
    transferaccountid: null,
    transferid: null,
    type: "Expense",
    updatedat: null,
    updatedby: null,
  },
  {
    id: "tr-5",
    accountid: "acc-5",
    amount: 120,
    categoryid: "tc-5",
    createdat: "2025-01-05T10:00:00Z",
    createdby: "0742f34e-7c12-408a-91a2-ed95d355bc87",
    date: "2025-01-05T10:00:00Z",
    description: "Doctor visit",
    isdeleted: false,
    isvoid: false,
    name: "Doctor Visits",
    notes: null,
    payee: "Clinic",
    tags: ["healthcare"],
    tenantid: "0742f34e-7c12-408a-91a2-ed95d355bc87",
    transferaccountid: null,
    transferid: null,
    type: "Expense",
    updatedat: null,
    updatedby: null,
  },
  {
    id: "tr-6",
    accountid: "acc-6",
    amount: 60,
    categoryid: "tc-6",
    createdat: "2025-01-06T10:00:00Z",
    createdby: "0742f34e-7c12-408a-91a2-ed95d355bc87",
    date: "2025-01-06T10:00:00Z",
    description: "Internet bill",
    isdeleted: false,
    isvoid: false,
    name: "Internet",
    notes: null,
    payee: "ISP",
    tags: ["utilities"],
    tenantid: "0742f34e-7c12-408a-91a2-ed95d355bc87",
    transferaccountid: null,
    transferid: null,
    type: "Expense",
    updatedat: null,
    updatedby: null,
  },
  {
    id: "tr-7",
    accountid: "acc-7",
    amount: 45,
    categoryid: "tc-7",
    createdat: "2025-01-07T10:00:00Z",
    createdby: "0742f34e-7c12-408a-91a2-ed95d355bc87",
    date: "2025-01-07T10:00:00Z",
    description: "Bought new game",
    isdeleted: false,
    isvoid: false,
    name: "Games",
    notes: null,
    payee: "Game Store",
    tags: ["leisure"],
    tenantid: "0742f34e-7c12-408a-91a2-ed95d355bc87",
    transferaccountid: null,
    transferid: null,
    type: "Expense",
    updatedat: null,
    updatedby: null,
  },
  {
    id: "tr-8",
    accountid: "acc-8",
    amount: 35,
    categoryid: "tc-8",
    createdat: "2025-01-08T10:00:00Z",
    createdby: "0742f34e-7c12-408a-91a2-ed95d355bc87",
    date: "2025-01-08T10:00:00Z",
    description: "Water bill",
    isdeleted: false,
    isvoid: false,
    name: "Water",
    notes: null,
    payee: "Water Utility",
    tags: ["utilities"],
    tenantid: "0742f34e-7c12-408a-91a2-ed95d355bc87",
    transferaccountid: null,
    transferid: null,
    type: "Expense",
    updatedat: null,
    updatedby: null,
  },
  {
    id: "tr-9",
    accountid: "acc-9",
    amount: 60,
    categoryid: "tc-9",
    createdat: "2025-01-09T10:00:00Z",
    createdby: "0742f34e-7c12-408a-91a2-ed95d355bc87",
    date: "2025-01-09T10:00:00Z",
    description: "Pharmacy purchase",
    isdeleted: false,
    isvoid: false,
    name: "Pharmacy",
    notes: null,
    payee: "Pharmacy",
    tags: ["healthcare"],
    tenantid: "0742f34e-7c12-408a-91a2-ed95d355bc87",
    transferaccountid: null,
    transferid: null,
    type: "Expense",
    updatedat: null,
    updatedby: null,
  },
  {
    id: "tr-10",
    accountid: "acc-10",
    amount: 800,
    categoryid: "tc-10",
    createdat: "2025-01-10T10:00:00Z",
    createdby: "0742f34e-7c12-408a-91a2-ed95d355bc87",
    date: "2025-01-10T10:00:00Z",
    description: "Freelance payment",
    isdeleted: false,
    isvoid: false,
    name: "Freelance Income",
    notes: null,
    payee: "Client",
    tags: ["income"],
    tenantid: "0742f34e-7c12-408a-91a2-ed95d355bc87",
    transferaccountid: null,
    transferid: null,
    type: "Income",
    updatedat: null,
    updatedby: null,
  },
  {
    id: "tr-11",
    accountid: "acc-1",
    amount: 70,
    categoryid: "tc-3",
    createdat: "2025-01-11T10:00:00Z",
    createdby: "0742f34e-7c12-408a-91a2-ed95d355bc87",
    date: "2025-01-11T10:00:00Z",
    description: "Lunch with friends",
    isdeleted: false,
    isvoid: false,
    name: "Dining Out",
    notes: null,
    payee: "Cafe",
    tags: ["leisure"],
    tenantid: "0742f34e-7c12-408a-91a2-ed95d355bc87",
    transferaccountid: null,
    transferid: null,
    type: "Expense",
    updatedat: null,
    updatedby: null,
  },
  {
    id: "tr-12",
    accountid: "acc-2",
    amount: 3200,
    categoryid: "tc-2",
    createdat: "2025-01-12T10:00:00Z",
    createdby: "0742f34e-7c12-408a-91a2-ed95d355bc87",
    date: "2025-01-12T10:00:00Z",
    description: "Salary for February",
    isdeleted: false,
    isvoid: false,
    name: "Salary",
    notes: null,
    payee: "Company",
    tags: ["income"],
    tenantid: "0742f34e-7c12-408a-91a2-ed95d355bc87",
    transferaccountid: null,
    transferid: null,
    type: "Income",
    updatedat: null,
    updatedby: null,
  },
  {
    id: "tr-13",
    accountid: "acc-3",
    amount: 90,
    categoryid: "tc-1",
    createdat: "2025-01-13T10:00:00Z",
    createdby: "0742f34e-7c12-408a-91a2-ed95d355bc87",
    date: "2025-01-13T10:00:00Z",
    description: "Weekly groceries",
    isdeleted: false,
    isvoid: false,
    name: "Groceries",
    notes: null,
    payee: "Supermarket",
    tags: ["food"],
    tenantid: "0742f34e-7c12-408a-91a2-ed95d355bc87",
    transferaccountid: null,
    transferid: null,
    type: "Expense",
    updatedat: null,
    updatedby: null,
  },
  {
    id: "tr-14",
    accountid: "acc-4",
    amount: 210,
    categoryid: "tc-4",
    createdat: "2025-01-14T10:00:00Z",
    createdby: "0742f34e-7c12-408a-91a2-ed95d355bc87",
    date: "2025-01-14T10:00:00Z",
    description: "Electricity bill",
    isdeleted: false,
    isvoid: false,
    name: "Electricity",
    notes: null,
    payee: "Utility Company",
    tags: ["utilities"],
    tenantid: "0742f34e-7c12-408a-91a2-ed95d355bc87",
    transferaccountid: null,
    transferid: null,
    type: "Expense",
    updatedat: null,
    updatedby: null,
  },
  {
    id: "tr-15",
    accountid: "acc-5",
    amount: 130,
    categoryid: "tc-5",
    createdat: "2025-01-15T10:00:00Z",
    createdby: "0742f34e-7c12-408a-91a2-ed95d355bc87",
    date: "2025-01-15T10:00:00Z",
    description: "Doctor visit",
    isdeleted: false,
    isvoid: false,
    name: "Doctor Visits",
    notes: null,
    payee: "Clinic",
    tags: ["healthcare"],
    tenantid: "0742f34e-7c12-408a-91a2-ed95d355bc87",
    transferaccountid: null,
    transferid: null,
    type: "Expense",
    updatedat: null,
    updatedby: null,
  },
  {
    id: "tr-16",
    accountid: "acc-6",
    amount: 65,
    categoryid: "tc-6",
    createdat: "2025-01-16T10:00:00Z",
    createdby: "0742f34e-7c12-408a-91a2-ed95d355bc87",
    date: "2025-01-16T10:00:00Z",
    description: "Internet bill",
    isdeleted: false,
    isvoid: false,
    name: "Internet",
    notes: null,
    payee: "ISP",
    tags: ["utilities"],
    tenantid: "0742f34e-7c12-408a-91a2-ed95d355bc87",
    transferaccountid: null,
    transferid: null,
    type: "Expense",
    updatedat: null,
    updatedby: null,
  },
  {
    id: "tr-17",
    accountid: "acc-7",
    amount: 55,
    categoryid: "tc-7",
    createdat: "2025-01-17T10:00:00Z",
    createdby: "0742f34e-7c12-408a-91a2-ed95d355bc87",
    date: "2025-01-17T10:00:00Z",
    description: "Bought new game",
    isdeleted: false,
    isvoid: false,
    name: "Games",
    notes: null,
    payee: "Game Store",
    tags: ["leisure"],
    tenantid: "0742f34e-7c12-408a-91a2-ed95d355bc87",
    transferaccountid: null,
    transferid: null,
    type: "Expense",
    updatedat: null,
    updatedby: null,
  },
  {
    id: "tr-18",
    accountid: "acc-8",
    amount: 38,
    categoryid: "tc-8",
    createdat: "2025-01-18T10:00:00Z",
    createdby: "0742f34e-7c12-408a-91a2-ed95d355bc87",
    date: "2025-01-18T10:00:00Z",
    description: "Water bill",
    isdeleted: false,
    isvoid: false,
    name: "Water",
    notes: null,
    payee: "Water Utility",
    tags: ["utilities"],
    tenantid: "0742f34e-7c12-408a-91a2-ed95d355bc87",
    transferaccountid: null,
    transferid: null,
    type: "Expense",
    updatedat: null,
    updatedby: null,
  },
  {
    id: "tr-19",
    accountid: "acc-9",
    amount: 70,
    categoryid: "tc-9",
    createdat: "2025-01-19T10:00:00Z",
    createdby: "0742f34e-7c12-408a-91a2-ed95d355bc87",
    date: "2025-01-19T10:00:00Z",
    description: "Pharmacy purchase",
    isdeleted: false,
    isvoid: false,
    name: "Pharmacy",
    notes: null,
    payee: "Pharmacy",
    tags: ["healthcare"],
    tenantid: "0742f34e-7c12-408a-91a2-ed95d355bc87",
    transferaccountid: null,
    transferid: null,
    type: "Expense",
    updatedat: null,
    updatedby: null,
  },
  {
    id: "tr-20",
    accountid: "acc-10",
    amount: 900,
    categoryid: "tc-10",
    createdat: "2025-01-20T10:00:00Z",
    createdby: "0742f34e-7c12-408a-91a2-ed95d355bc87",
    date: "2025-01-20T10:00:00Z",
    description: "Freelance payment",
    isdeleted: false,
    isvoid: false,
    name: "Freelance Income",
    notes: null,
    payee: "Client",
    tags: ["income"],
    tenantid: "0742f34e-7c12-408a-91a2-ed95d355bc87",
    transferaccountid: null,
    transferid: null,
    type: "Income",
    updatedat: null,
    updatedby: null,
  },
  {
    id: "tr-21",
    accountid: "acc-1",
    amount: 55,
    categoryid: "tc-1",
    createdat: "2025-01-21T10:00:00Z",
    createdby: "0742f34e-7c12-408a-91a2-ed95d355bc87",
    date: "2025-01-21T10:00:00Z",
    description: "Groceries",
    isdeleted: false,
    isvoid: false,
    name: "Groceries",
    notes: null,
    payee: "Supermarket",
    tags: ["food"],
    tenantid: "0742f34e-7c12-408a-91a2-ed95d355bc87",
    transferaccountid: null,
    transferid: null,
    type: "Expense",
    updatedat: null,
    updatedby: null,
  },
  {
    id: "tr-22",
    accountid: "acc-2",
    amount: 3100,
    categoryid: "tc-2",
    createdat: "2025-01-22T10:00:00Z",
    createdby: "0742f34e-7c12-408a-91a2-ed95d355bc87",
    date: "2025-01-22T10:00:00Z",
    description: "Salary for March",
    isdeleted: false,
    isvoid: false,
    name: "Salary",
    notes: null,
    payee: "Company",
    tags: ["income"],
    tenantid: "0742f34e-7c12-408a-91a2-ed95d355bc87",
    transferaccountid: null,
    transferid: null,
    type: "Income",
    updatedat: null,
    updatedby: null,
  },
  {
    id: "tr-23",
    accountid: "acc-3",
    amount: 110,
    categoryid: "tc-3",
    createdat: "2025-01-23T10:00:00Z",
    createdby: "0742f34e-7c12-408a-91a2-ed95d355bc87",
    date: "2025-01-23T10:00:00Z",
    description: "Dinner out",
    isdeleted: false,
    isvoid: false,
    name: "Dining Out",
    notes: null,
    payee: "Restaurant",
    tags: ["leisure"],
    tenantid: "0742f34e-7c12-408a-91a2-ed95d355bc87",
    transferaccountid: null,
    transferid: null,
    type: "Expense",
    updatedat: null,
    updatedby: null,
  },
  {
    id: "tr-24",
    accountid: "acc-4",
    amount: 205,
    categoryid: "tc-4",
    createdat: "2025-01-24T10:00:00Z",
    createdby: "0742f34e-7c12-408a-91a2-ed95d355bc87",
    date: "2025-01-24T10:00:00Z",
    description: "Electricity bill",
    isdeleted: false,
    isvoid: false,
    name: "Electricity",
    notes: null,
    payee: "Utility Company",
    tags: ["utilities"],
    tenantid: "0742f34e-7c12-408a-91a2-ed95d355bc87",
    transferaccountid: null,
    transferid: null,
    type: "Expense",
    updatedat: null,
    updatedby: null,
  },
  {
    id: "tr-25",
    accountid: "acc-5",
    amount: 140,
    categoryid: "tc-5",
    createdat: "2025-01-25T10:00:00Z",
    createdby: "0742f34e-7c12-408a-91a2-ed95d355bc87",
    date: "2025-01-25T10:00:00Z",
    description: "Doctor visit",
    isdeleted: false,
    isvoid: false,
    name: "Doctor Visits",
    notes: null,
    payee: "Clinic",
    tags: ["healthcare"],
    tenantid: "0742f34e-7c12-408a-91a2-ed95d355bc87",
    transferaccountid: null,
    transferid: null,
    type: "Expense",
    updatedat: null,
    updatedby: null,
  },
  {
    id: "tr-26",
    accountid: "acc-6",
    amount: 70,
    categoryid: "tc-6",
    createdat: "2025-01-26T10:00:00Z",
    createdby: "0742f34e-7c12-408a-91a2-ed95d355bc87",
    date: "2025-01-26T10:00:00Z",
    description: "Internet bill",
    isdeleted: false,
    isvoid: false,
    name: "Internet",
    notes: null,
    payee: "ISP",
    tags: ["utilities"],
    tenantid: "0742f34e-7c12-408a-91a2-ed95d355bc87",
    transferaccountid: null,
    transferid: null,
    type: "Expense",
    updatedat: null,
    updatedby: null,
  },
  {
    id: "tr-27",
    accountid: "acc-7",
    amount: 60,
    categoryid: "tc-7",
    createdat: "2025-01-27T10:00:00Z",
    createdby: "0742f34e-7c12-408a-91a2-ed95d355bc87",
    date: "2025-01-27T10:00:00Z",
    description: "Bought new game",
    isdeleted: false,
    isvoid: false,
    name: "Games",
    notes: null,
    payee: "Game Store",
    tags: ["leisure"],
    tenantid: "0742f34e-7c12-408a-91a2-ed95d355bc87",
    transferaccountid: null,
    transferid: null,
    type: "Expense",
    updatedat: null,
    updatedby: null,
  },
  {
    id: "tr-28",
    accountid: "acc-8",
    amount: 40,
    categoryid: "tc-8",
    createdat: "2025-01-28T10:00:00Z",
    createdby: "0742f34e-7c12-408a-91a2-ed95d355bc87",
    date: "2025-01-28T10:00:00Z",
    description: "Water bill",
    isdeleted: false,
    isvoid: false,
    name: "Water",
    notes: null,
    payee: "Water Utility",
    tags: ["utilities"],
    tenantid: "0742f34e-7c12-408a-91a2-ed95d355bc87",
    transferaccountid: null,
    transferid: null,
    type: "Expense",
    updatedat: null,
    updatedby: null,
  },
  {
    id: "tr-29",
    accountid: "acc-9",
    amount: 80,
    categoryid: "tc-9",
    createdat: "2025-01-29T10:00:00Z",
    createdby: "0742f34e-7c12-408a-91a2-ed95d355bc87",
    date: "2025-01-29T10:00:00Z",
    description: "Pharmacy purchase",
    isdeleted: false,
    isvoid: false,
    name: "Pharmacy",
    notes: null,
    payee: "Pharmacy",
    tags: ["healthcare"],
    tenantid: "0742f34e-7c12-408a-91a2-ed95d355bc87",
    transferaccountid: null,
    transferid: null,
    type: "Expense",
    updatedat: null,
    updatedby: null,
  },
  {
    id: "tr-30",
    accountid: "acc-10",
    amount: 1000,
    categoryid: "tc-10",
    createdat: "2025-01-30T10:00:00Z",
    createdby: "0742f34e-7c12-408a-91a2-ed95d355bc87",
    date: "2025-01-30T10:00:00Z",
    description: "Freelance payment",
    isdeleted: false,
    isvoid: false,
    name: "Freelance Income",
    notes: null,
    payee: "Client",
    tags: ["income"],
    tenantid: "0742f34e-7c12-408a-91a2-ed95d355bc87",
    transferaccountid: null,
    transferid: null,
    type: "Income",
    updatedat: null,
    updatedby: null,
  },
];

let inMemoryTransactions = [...mockTransactions];

const toTransactionsView = (tr: Transaction): TransactionsView => ({
  accountid: tr.accountid,
  accountname: null,
  amount: tr.amount,
  balance: null,
  categoryid: tr.categoryid,
  categoryname: null,
  createdat: tr.createdat,
  currency: null,
  date: tr.date,
  groupicon: null,
  groupid: null,
  groupname: null,
  icon: null,
  id: tr.id,
  isvoid: tr.isvoid,
  name: tr.name,
  payee: tr.payee,
  runningbalance: null,
  tenantid: tr.tenantid,
  transferaccountid: tr.transferaccountid,
  transferid: tr.transferid,
  type: tr.type,
  updatedat: tr.updatedat,
});

export const useGetAllTransactions = () => {
  return useQuery<TransactionsView[]>({
    queryKey: ["Transactions", "demo"],
    queryFn: async () => inMemoryTransactions.map(toTransactionsView),
    initialData: inMemoryTransactions.map(toTransactionsView),
  });
};

export const useGetTransactions = (searchFilters: TransactionFilters) => {
  // For demo, ignore filters and return all
  return useQuery<TransactionsView[]>({
    queryKey: ["TransactionsView", searchFilters, "demo"],
    queryFn: async () => inMemoryTransactions.map(toTransactionsView),
    initialData: inMemoryTransactions.map(toTransactionsView),
  });
};

export const useGetTransactionsInfinite = (searchParams: TransactionFilters) => {
  // For demo, ignore filters and paginate mock data
  const pageSize = 10;
  return useInfiniteQuery<TransactionsView[]>({
    queryKey: ["TransactionsView", searchParams, "demo"],
    initialPageParam: 0,
    queryFn: async ({ pageParam = 0 }) => {
      const startIndex = (pageParam as number) * pageSize;
      const endIndex = startIndex + pageSize;
      return inMemoryTransactions.slice(startIndex, endIndex).map(toTransactionsView);
    },
    getNextPageParam: (lastPage, allPages) => {
      if (lastPage.length < pageSize) return undefined;
      return allPages.length;
    },
  });
};

export const useGetTransactionById = (id?: string | null | undefined) => {
  return useQuery<Transaction | undefined>({
    queryKey: ["Transactions", id, "demo"],
    queryFn: async () => inMemoryTransactions.find(tr => tr.id === id),
    enabled: !!id,
    initialData: () => inMemoryTransactions.find(tr => tr.id === id),
  });
};

export const useCreateTransaction = () => {
  return useMutation({
    mutationFn: async (transaction: Partial<Transaction>) => {
      const newTransaction = {
        ...transaction,
        id: `tr-${Date.now()}`,
        createdat: new Date().toISOString(),
        createdby: "0742f34e-7c12-408a-91a2-ed95d355bc87",
        isdeleted: false,
        isvoid: false,
        tenantid: "0742f34e-7c12-408a-91a2-ed95d355bc87",
      } as Transaction;
      inMemoryTransactions = [...inMemoryTransactions, newTransaction];
      return newTransaction;
    },
  });
};

export const useCreateTransactions = () => {
  return useMutation({
    mutationFn: async ({ transactionsGroup, totalAmount }: { transactionsGroup: any; totalAmount: number }) => {
      // For demo, just add a single transaction
      const newTransaction = {
        id: `tr-${Date.now()}`,
        accountid: transactionsGroup.accountid,
        amount: totalAmount,
        categoryid: "tc-1",
        createdat: new Date().toISOString(),
        createdby: "0742f34e-7c12-408a-91a2-ed95d355bc87",
        date: new Date().toISOString(),
        description: transactionsGroup.description,
        isdeleted: false,
        isvoid: false,
        name: transactionsGroup.name || "Multi",
        notes: null,
        payee: transactionsGroup.payee,
        tags: [],
        tenantid: "0742f34e-7c12-408a-91a2-ed95d355bc87",
        transferaccountid: null,
        transferid: null,
        type: transactionsGroup.type || "Expense",
        updatedat: null,
        updatedby: null,
      } as Transaction;
      inMemoryTransactions = [...inMemoryTransactions, newTransaction];
      return [newTransaction];
    },
  });
};

export const useUpdateTransaction = () => {
  return useMutation({
    mutationFn: async ({ accountGroup }: { accountGroup: Partial<Transaction>; originalData: Transaction }) => {
      inMemoryTransactions = inMemoryTransactions.map(tr =>
        tr.id === accountGroup.id ? { ...tr, ...accountGroup, updatedat: new Date().toISOString() } : tr,
      );
      return inMemoryTransactions.find(tr => tr.id === accountGroup.id);
    },
  });
};

export const useUpsertTransaction = () => {
  return useMutation({
    mutationFn: async ({ formData, originalData }: { formData: Partial<Transaction>; originalData?: Transaction }) => {
      if (formData.id && originalData) {
        inMemoryTransactions = inMemoryTransactions.map(tr =>
          tr.id === formData.id ? { ...tr, ...formData, updatedat: new Date().toISOString() } : tr,
        );
        return inMemoryTransactions.find(tr => tr.id === formData.id);
      }
      const newTransaction = {
        ...formData,
        id: `tr-${Date.now()}`,
        createdat: new Date().toISOString(),
        createdby: "0742f34e-7c12-408a-91a2-ed95d355bc87",
        isdeleted: false,
        isvoid: false,
        tenantid: "0742f34e-7c12-408a-91a2-ed95d355bc87",
      } as Transaction;
      inMemoryTransactions = [...inMemoryTransactions, newTransaction];
      return newTransaction;
    },
  });
};

export const useDeleteTransaction = () => {
  return useMutation({
    mutationFn: async (id: string) => {
      inMemoryTransactions = inMemoryTransactions.map(tr =>
        tr.id === id ? { ...tr, isdeleted: true, updatedat: new Date().toISOString() } : tr,
      );
      return inMemoryTransactions.find(tr => tr.id === id);
    },
  });
};

export const useRestoreTransaction = () => {
  return useMutation({
    mutationFn: async (id: string) => {
      inMemoryTransactions = inMemoryTransactions.map(tr =>
        tr.id === id ? { ...tr, isdeleted: false, updatedat: new Date().toISOString() } : tr,
      );
      return inMemoryTransactions.find(tr => tr.id === id);
    },
  });
};
