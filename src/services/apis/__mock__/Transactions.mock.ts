// Mock implementation for Transactions API

import { Transaction, TransactionsView } from "@/src/types/db/Tables.Types";

const mockTransactions: Transaction[] = [
  {
    id: "tr-1",
    accountid: "acc-1",
    amount: 50,
    categoryid: "tc-1",
    createdat: "2025-01-01T10:00:00Z",
    createdby: "0742f34e-7c12-408a-91a2-ed95d355bc87",
    date: "2025-01-01T10:00:00Z",
    description: "Grocery shopping",
    isdeleted: false,
    isvoid: false,
    name: "Groceries",
    notes: "Bought fruits and vegetables",
    payee: "Supermarket",
    tags: ["food"],
    tenantid: "0742f34e-7c12-408a-91a2-ed95d355bc87",
    transferaccountid: null,
    transferid: null,
    type: "Expense",
    updatedat: null,
    updatedby: null,
  },
  {
    id: "tr-2",
    accountid: "acc-2",
    amount: 3000,
    categoryid: "tc-2",
    createdat: "2025-01-02T10:00:00Z",
    createdby: "0742f34e-7c12-408a-91a2-ed95d355bc87",
    date: "2025-01-02T10:00:00Z",
    description: "Salary for January",
    isdeleted: false,
    isvoid: false,
    name: "Salary",
    notes: null,
    payee: "Company",
    tags: ["income"],
    tenantid: "0742f34e-7c12-408a-91a2-ed95d355bc87",
    transferaccountid: null,
    transferid: null,
    type: "Income",
    updatedat: null,
    updatedby: null,
  },
  {
    id: "tr-3",
    accountid: "acc-3",
    amount: 100,
    categoryid: "tc-3",
    createdat: "2025-01-03T10:00:00Z",
    createdby: "0742f34e-7c12-408a-91a2-ed95d355bc87",
    date: "2025-01-03T10:00:00Z",
    description: "Dinner at restaurant",
    isdeleted: false,
    isvoid: false,
    name: "Dining Out",
    notes: null,
    payee: "Pizza Place",
    tags: ["food", "leisure"],
    tenantid: "0742f34e-7c12-408a-91a2-ed95d355bc87",
    transferaccountid: null,
    transferid: null,
    type: "Expense",
    updatedat: null,
    updatedby: null,
  },
  {
    id: "tr-4",
    accountid: "acc-4",
    amount: 200,
    categoryid: "tc-4",
    createdat: "2025-01-04T10:00:00Z",
    createdby: "0742f34e-7c12-408a-91a2-ed95d355bc87",
    date: "2025-01-04T10:00:00Z",
    description: "Electricity bill",
    isdeleted: false,
    isvoid: false,
    name: "Electricity",
    notes: null,
    payee: "Utility Company",
    tags: ["utilities"],
    tenantid: "0742f34e-7c12-408a-91a2-ed95d355bc87",
    transferaccountid: null,
    transferid: null,
    type: "Expense",
    updatedat: null,
    updatedby: null,
  },
  {
    id: "tr-5",
    accountid: "acc-5",
    amount: 120,
    categoryid: "tc-5",
    createdat: "2025-01-05T10:00:00Z",
    createdby: "0742f34e-7c12-408a-91a2-ed95d355bc87",
    date: "2025-01-05T10:00:00Z",
    description: "Doctor visit",
    isdeleted: false,
    isvoid: false,
    name: "Doctor Visits",
    notes: null,
    payee: "Clinic",
    tags: ["healthcare"],
    tenantid: "0742f34e-7c12-408a-91a2-ed95d355bc87",
    transferaccountid: null,
    transferid: null,
    type: "Expense",
    updatedat: null,
    updatedby: null,
  },
  {
    id: "tr-6",
    accountid: "acc-6",
    amount: 60,
    categoryid: "tc-6",
    createdat: "2025-01-06T10:00:00Z",
    createdby: "0742f34e-7c12-408a-91a2-ed95d355bc87",
    date: "2025-01-06T10:00:00Z",
    description: "Internet bill",
    isdeleted: false,
    isvoid: false,
    name: "Internet",
    notes: null,
    payee: "ISP",
    tags: ["utilities"],
    tenantid: "0742f34e-7c12-408a-91a2-ed95d355bc87",
    transferaccountid: null,
    transferid: null,
    type: "Expense",
    updatedat: null,
    updatedby: null,
  },
  {
    id: "tr-7",
    accountid: "acc-7",
    amount: 45,
    categoryid: "tc-7",
    createdat: "2025-01-07T10:00:00Z",
    createdby: "0742f34e-7c12-408a-91a2-ed95d355bc87",
    date: "2025-01-07T10:00:00Z",
    description: "Bought new game",
    isdeleted: false,
    isvoid: false,
    name: "Games",
    notes: null,
    payee: "Game Store",
    tags: ["leisure"],
    tenantid: "0742f34e-7c12-408a-91a2-ed95d355bc87",
    transferaccountid: null,
    transferid: null,
    type: "Expense",
    updatedat: null,
    updatedby: null,
  },
  {
    id: "tr-8",
    accountid: "acc-8",
    amount: 35,
    categoryid: "tc-8",
    createdat: "2025-01-08T10:00:00Z",
    createdby: "0742f34e-7c12-408a-91a2-ed95d355bc87",
    date: "2025-01-08T10:00:00Z",
    description: "Water bill",
    isdeleted: false,
    isvoid: false,
    name: "Water",
    notes: null,
    payee: "Water Utility",
    tags: ["utilities"],
    tenantid: "0742f34e-7c12-408a-91a2-ed95d355bc87",
    transferaccountid: null,
    transferid: null,
    type: "Expense",
    updatedat: null,
    updatedby: null,
  },
  {
    id: "tr-9",
    accountid: "acc-9",
    amount: 60,
    categoryid: "tc-9",
    createdat: "2025-01-09T10:00:00Z",
    createdby: "0742f34e-7c12-408a-91a2-ed95d355bc87",
    date: "2025-01-09T10:00:00Z",
    description: "Pharmacy purchase",
    isdeleted: false,
    isvoid: false,
    name: "Pharmacy",
    notes: null,
    payee: "Pharmacy",
    tags: ["healthcare"],
    tenantid: "0742f34e-7c12-408a-91a2-ed95d355bc87",
    transferaccountid: null,
    transferid: null,
    type: "Expense",
    updatedat: null,
    updatedby: null,
  },
  {
    id: "tr-10",
    accountid: "acc-10",
    amount: 800,
    categoryid: "tc-10",
    createdat: "2025-01-10T10:00:00Z",
    createdby: "0742f34e-7c12-408a-91a2-ed95d355bc87",
    date: "2025-01-10T10:00:00Z",
    description: "Freelance payment",
    isdeleted: false,
    isvoid: false,
    name: "Freelance Income",
    notes: null,
    payee: "Client",
    tags: ["income"],
    tenantid: "0742f34e-7c12-408a-91a2-ed95d355bc87",
    transferaccountid: null,
    transferid: null,
    type: "Income",
    updatedat: null,
    updatedby: null,
  },
  {
    id: "tr-11",
    accountid: "acc-1",
    amount: 70,
    categoryid: "tc-3",
    createdat: "2025-01-11T10:00:00Z",
    createdby: "0742f34e-7c12-408a-91a2-ed95d355bc87",
    date: "2025-01-11T10:00:00Z",
    description: "Lunch with friends",
    isdeleted: false,
    isvoid: false,
    name: "Dining Out",
    notes: null,
    payee: "Cafe",
    tags: ["leisure"],
    tenantid: "0742f34e-7c12-408a-91a2-ed95d355bc87",
    transferaccountid: null,
    transferid: null,
    type: "Expense",
    updatedat: null,
    updatedby: null,
  },
  {
    id: "tr-12",
    accountid: "acc-2",
    amount: 3200,
    categoryid: "tc-2",
    createdat: "2025-01-12T10:00:00Z",
    createdby: "0742f34e-7c12-408a-91a2-ed95d355bc87",
    date: "2025-01-12T10:00:00Z",
    description: "Salary for February",
    isdeleted: false,
    isvoid: false,
    name: "Salary",
    notes: null,
    payee: "Company",
    tags: ["income"],
    tenantid: "0742f34e-7c12-408a-91a2-ed95d355bc87",
    transferaccountid: null,
    transferid: null,
    type: "Income",
    updatedat: null,
    updatedby: null,
  },
  {
    id: "tr-13",
    accountid: "acc-3",
    amount: 90,
    categoryid: "tc-1",
    createdat: "2025-01-13T10:00:00Z",
    createdby: "0742f34e-7c12-408a-91a2-ed95d355bc87",
    date: "2025-01-13T10:00:00Z",
    description: "Weekly groceries",
    isdeleted: false,
    isvoid: false,
    name: "Groceries",
    notes: null,
    payee: "Supermarket",
    tags: ["food"],
    tenantid: "0742f34e-7c12-408a-91a2-ed95d355bc87",
    transferaccountid: null,
    transferid: null,
    type: "Expense",
    updatedat: null,
    updatedby: null,
  },
  {
    id: "tr-14",
    accountid: "acc-4",
    amount: 210,
    categoryid: "tc-4",
    createdat: "2025-01-14T10:00:00Z",
    createdby: "0742f34e-7c12-408a-91a2-ed95d355bc87",
    date: "2025-01-14T10:00:00Z",
    description: "Electricity bill",
    isdeleted: false,
    isvoid: false,
    name: "Electricity",
    notes: null,
    payee: "Utility Company",
    tags: ["utilities"],
    tenantid: "0742f34e-7c12-408a-91a2-ed95d355bc87",
    transferaccountid: null,
    transferid: null,
    type: "Expense",
    updatedat: null,
    updatedby: null,
  },
  {
    id: "tr-15",
    accountid: "acc-5",
    amount: 130,
    categoryid: "tc-5",
    createdat: "2025-01-15T10:00:00Z",
    createdby: "0742f34e-7c12-408a-91a2-ed95d355bc87",
    date: "2025-01-15T10:00:00Z",
    description: "Doctor visit",
    isdeleted: false,
    isvoid: false,
    name: "Doctor Visits",
    notes: null,
    payee: "Clinic",
    tags: ["healthcare"],
    tenantid: "0742f34e-7c12-408a-91a2-ed95d355bc87",
    transferaccountid: null,
    transferid: null,
    type: "Expense",
    updatedat: null,
    updatedby: null,
  },
  {
    id: "tr-16",
    accountid: "acc-6",
    amount: 65,
    categoryid: "tc-6",
    createdat: "2025-01-16T10:00:00Z",
    createdby: "0742f34e-7c12-408a-91a2-ed95d355bc87",
    date: "2025-01-16T10:00:00Z",
    description: "Internet bill",
    isdeleted: false,
    isvoid: false,
    name: "Internet",
    notes: null,
    payee: "ISP",
    tags: ["utilities"],
    tenantid: "0742f34e-7c12-408a-91a2-ed95d355bc87",
    transferaccountid: null,
    transferid: null,
    type: "Expense",
    updatedat: null,
    updatedby: null,
  },
  {
    id: "tr-17",
    accountid: "acc-7",
    amount: 55,
    categoryid: "tc-7",
    createdat: "2025-01-17T10:00:00Z",
    createdby: "0742f34e-7c12-408a-91a2-ed95d355bc87",
    date: "2025-01-17T10:00:00Z",
    description: "Bought new game",
    isdeleted: false,
    isvoid: false,
    name: "Games",
    notes: null,
    payee: "Game Store",
    tags: ["leisure"],
    tenantid: "0742f34e-7c12-408a-91a2-ed95d355bc87",
    transferaccountid: null,
    transferid: null,
    type: "Expense",
    updatedat: null,
    updatedby: null,
  },
  {
    id: "tr-18",
    accountid: "acc-8",
    amount: 38,
    categoryid: "tc-8",
    createdat: "2025-01-18T10:00:00Z",
    createdby: "0742f34e-7c12-408a-91a2-ed95d355bc87",
    date: "2025-01-18T10:00:00Z",
    description: "Water bill",
    isdeleted: false,
    isvoid: false,
    name: "Water",
    notes: null,
    payee: "Water Utility",
    tags: ["utilities"],
    tenantid: "0742f34e-7c12-408a-91a2-ed95d355bc87",
    transferaccountid: null,
    transferid: null,
    type: "Expense",
    updatedat: null,
    updatedby: null,
  },
  {
    id: "tr-19",
    accountid: "acc-9",
    amount: 70,
    categoryid: "tc-9",
    createdat: "2025-01-19T10:00:00Z",
    createdby: "0742f34e-7c12-408a-91a2-ed95d355bc87",
    date: "2025-01-19T10:00:00Z",
    description: "Pharmacy purchase",
    isdeleted: false,
    isvoid: false,
    name: "Pharmacy",
    notes: null,
    payee: "Pharmacy",
    tags: ["healthcare"],
    tenantid: "0742f34e-7c12-408a-91a2-ed95d355bc87",
    transferaccountid: null,
    transferid: null,
    type: "Expense",
    updatedat: null,
    updatedby: null,
  },
  {
    id: "tr-20",
    accountid: "acc-10",
    amount: 900,
    categoryid: "tc-10",
    createdat: "2025-01-20T10:00:00Z",
    createdby: "0742f34e-7c12-408a-91a2-ed95d355bc87",
    date: "2025-01-20T10:00:00Z",
    description: "Freelance payment",
    isdeleted: false,
    isvoid: false,
    name: "Freelance Income",
    notes: null,
    payee: "Client",
    tags: ["income"],
    tenantid: "0742f34e-7c12-408a-91a2-ed95d355bc87",
    transferaccountid: null,
    transferid: null,
    type: "Income",
    updatedat: null,
    updatedby: null,
  },
  {
    id: "tr-21",
    accountid: "acc-1",
    amount: 55,
    categoryid: "tc-1",
    createdat: "2025-01-21T10:00:00Z",
    createdby: "0742f34e-7c12-408a-91a2-ed95d355bc87",
    date: "2025-01-21T10:00:00Z",
    description: "Groceries",
    isdeleted: false,
    isvoid: false,
    name: "Groceries",
    notes: null,
    payee: "Supermarket",
    tags: ["food"],
    tenantid: "0742f34e-7c12-408a-91a2-ed95d355bc87",
    transferaccountid: null,
    transferid: null,
    type: "Expense",
    updatedat: null,
    updatedby: null,
  },
  {
    id: "tr-22",
    accountid: "acc-2",
    amount: 3100,
    categoryid: "tc-2",
    createdat: "2025-01-22T10:00:00Z",
    createdby: "0742f34e-7c12-408a-91a2-ed95d355bc87",
    date: "2025-01-22T10:00:00Z",
    description: "Salary for March",
    isdeleted: false,
    isvoid: false,
    name: "Salary",
    notes: null,
    payee: "Company",
    tags: ["income"],
    tenantid: "0742f34e-7c12-408a-91a2-ed95d355bc87",
    transferaccountid: null,
    transferid: null,
    type: "Income",
    updatedat: null,
    updatedby: null,
  },
  {
    id: "tr-23",
    accountid: "acc-3",
    amount: 110,
    categoryid: "tc-3",
    createdat: "2025-01-23T10:00:00Z",
    createdby: "0742f34e-7c12-408a-91a2-ed95d355bc87",
    date: "2025-01-23T10:00:00Z",
    description: "Dinner out",
    isdeleted: false,
    isvoid: false,
    name: "Dining Out",
    notes: null,
    payee: "Restaurant",
    tags: ["leisure"],
    tenantid: "0742f34e-7c12-408a-91a2-ed95d355bc87",
    transferaccountid: null,
    transferid: null,
    type: "Expense",
    updatedat: null,
    updatedby: null,
  },
  {
    id: "tr-24",
    accountid: "acc-4",
    amount: 205,
    categoryid: "tc-4",
    createdat: "2025-01-24T10:00:00Z",
    createdby: "0742f34e-7c12-408a-91a2-ed95d355bc87",
    date: "2025-01-24T10:00:00Z",
    description: "Electricity bill",
    isdeleted: false,
    isvoid: false,
    name: "Electricity",
    notes: null,
    payee: "Utility Company",
    tags: ["utilities"],
    tenantid: "0742f34e-7c12-408a-91a2-ed95d355bc87",
    transferaccountid: null,
    transferid: null,
    type: "Expense",
    updatedat: null,
    updatedby: null,
  },
  {
    id: "tr-25",
    accountid: "acc-5",
    amount: 140,
    categoryid: "tc-5",
    createdat: "2025-01-25T10:00:00Z",
    createdby: "0742f34e-7c12-408a-91a2-ed95d355bc87",
    date: "2025-01-25T10:00:00Z",
    description: "Doctor visit",
    isdeleted: false,
    isvoid: false,
    name: "Doctor Visits",
    notes: null,
    payee: "Clinic",
    tags: ["healthcare"],
    tenantid: "0742f34e-7c12-408a-91a2-ed95d355bc87",
    transferaccountid: null,
    transferid: null,
    type: "Expense",
    updatedat: null,
    updatedby: null,
  },
  {
    id: "tr-26",
    accountid: "acc-6",
    amount: 70,
    categoryid: "tc-6",
    createdat: "2025-01-26T10:00:00Z",
    createdby: "0742f34e-7c12-408a-91a2-ed95d355bc87",
    date: "2025-01-26T10:00:00Z",
    description: "Internet bill",
    isdeleted: false,
    isvoid: false,
    name: "Internet",
    notes: null,
    payee: "ISP",
    tags: ["utilities"],
    tenantid: "0742f34e-7c12-408a-91a2-ed95d355bc87",
    transferaccountid: null,
    transferid: null,
    type: "Expense",
    updatedat: null,
    updatedby: null,
  },
  {
    id: "tr-27",
    accountid: "acc-7",
    amount: 60,
    categoryid: "tc-7",
    createdat: "2025-01-27T10:00:00Z",
    createdby: "0742f34e-7c12-408a-91a2-ed95d355bc87",
    date: "2025-01-27T10:00:00Z",
    description: "Bought new game",
    isdeleted: false,
    isvoid: false,
    name: "Games",
    notes: null,
    payee: "Game Store",
    tags: ["leisure"],
    tenantid: "0742f34e-7c12-408a-91a2-ed95d355bc87",
    transferaccountid: null,
    transferid: null,
    type: "Expense",
    updatedat: null,
    updatedby: null,
  },
  {
    id: "tr-28",
    accountid: "acc-8",
    amount: 40,
    categoryid: "tc-8",
    createdat: "2025-01-28T10:00:00Z",
    createdby: "0742f34e-7c12-408a-91a2-ed95d355bc87",
    date: "2025-01-28T10:00:00Z",
    description: "Water bill",
    isdeleted: false,
    isvoid: false,
    name: "Water",
    notes: null,
    payee: "Water Utility",
    tags: ["utilities"],
    tenantid: "0742f34e-7c12-408a-91a2-ed95d355bc87",
    transferaccountid: null,
    transferid: null,
    type: "Expense",
    updatedat: null,
    updatedby: null,
  },
  {
    id: "tr-29",
    accountid: "acc-9",
    amount: 80,
    categoryid: "tc-9",
    createdat: "2025-01-29T10:00:00Z",
    createdby: "0742f34e-7c12-408a-91a2-ed95d355bc87",
    date: "2025-01-29T10:00:00Z",
    description: "Pharmacy purchase",
    isdeleted: false,
    isvoid: false,
    name: "Pharmacy",
    notes: null,
    payee: "Pharmacy",
    tags: ["healthcare"],
    tenantid: "0742f34e-7c12-408a-91a2-ed95d355bc87",
    transferaccountid: null,
    transferid: null,
    type: "Expense",
    updatedat: null,
    updatedby: null,
  },
  {
    id: "tr-30",
    accountid: "acc-10",
    amount: 1000,
    categoryid: "tc-10",
    createdat: "2025-01-30T10:00:00Z",
    createdby: "0742f34e-7c12-408a-91a2-ed95d355bc87",
    date: "2025-01-30T10:00:00Z",
    description: "Freelance payment",
    isdeleted: false,
    isvoid: false,
    name: "Freelance Income",
    notes: null,
    payee: "Client",
    tags: ["income"],
    tenantid: "0742f34e-7c12-408a-91a2-ed95d355bc87",
    transferaccountid: null,
    transferid: null,
    type: "Income",
    updatedat: null,
    updatedby: null,
  },
];

let inMemoryTransactions = [...mockTransactions];

const toTransactionsView = (tr: Transaction): TransactionsView => ({
  accountid: tr.accountid,
  accountname: null,
  amount: tr.amount,
  balance: null,
  categoryid: tr.categoryid,
  categoryname: null,
  createdat: tr.createdat,
  currency: null,
  date: tr.date,
  groupicon: null,
  groupid: null,
  groupname: null,
  icon: null,
  id: tr.id,
  isvoid: tr.isvoid,
  name: tr.name,
  payee: tr.payee,
  runningbalance: null,
  tenantid: tr.tenantid,
  transferaccountid: tr.transferaccountid,
  transferid: tr.transferid,
  type: tr.type,
  updatedat: tr.updatedat,
});

export const getAllTransactions = async (tenantId: string) => {
  return inMemoryTransactions.map(toTransactionsView);
};

export const getTransactions = async (searchFilters: any, tenantId: string) => {
  const { text, dateFrom, dateTo, type } = searchFilters;

  return inMemoryTransactions
    .filter(tr => tr.tenantid === tenantId)
    .filter(tr => {
      if (text) {
        return tr.name?.toLowerCase().includes(text.toLowerCase());
      }
      return true;
    })
    .filter(tr => {
      if (dateFrom && dateTo) {
        return tr.date >= dateFrom && tr.date <= dateTo;
      }
      return true;
    })
    .filter(tr => {
      if (type) {
        return tr.type === type;
      }
      return true;
    })
    .map(toTransactionsView);
};

export const getTransactionFullyById = async (transactionid: string, tenantId: string) => {
  const transaction = inMemoryTransactions.find(tr => tr.id === transactionid && tr.tenantid === tenantId);
  if (!transaction) {
    throw new Error("Transaction not found");
  }
  return transaction;
};

export const getTransactionById = async (transactionid: string, tenantId: string) => {
  const transaction = inMemoryTransactions.find(tr => tr.id === transactionid && tr.tenantid === tenantId);
  if (!transaction) {
    throw new Error("Transaction not found");
  }
  return transaction;
};

export const getTransactionByTransferId = async (id: string, tenantId: string) => {
  const transaction = inMemoryTransactions.find(tr => tr.transferid === id && tr.tenantid === tenantId);
  if (!transaction) {
    throw new Error("Transaction not found");
  }
  return transaction;
};

export const getTransactionsByName = async (text: string, tenantId: string) => {
  return inMemoryTransactions.filter(
    tr => tr.name?.toLowerCase().includes(text.toLowerCase()) && tr.tenantid === tenantId,
  );
};

export const createTransaction = async (transaction: any) => {
  const newTransaction = {
    ...transaction,
    transactionid: "mock-created",
  };
  inMemoryTransactions.push(newTransaction);
  return newTransaction;
};

export const createTransactions = async (transactions: any[]) => {
  const createdTransactions = transactions.map((t, i) => ({
    ...t,
    transactionid: `mock-created-${i}`,
  }));
  inMemoryTransactions.push(...createdTransactions);
  return createdTransactions;
};

export const createMultipleTransactions = async (transactions: any[]) => {
  const createdTransactions = transactions.map((t, i) => ({
    ...t,
    transactionid: `mock-multi-${i}`,
  }));
  inMemoryTransactions.push(...createdTransactions);
  return createdTransactions;
};

export const updateTransaction = async (transaction: any) => {
  const index = inMemoryTransactions.findIndex(tr => tr.id === transaction.id);
  if (index === -1) {
    throw new Error("Transaction not found");
  }
  inMemoryTransactions[index] = {
    ...inMemoryTransactions[index],
    ...transaction,
    updated: true,
  };
  return inMemoryTransactions[index];
};

export const updateTransferTransaction = async (transaction: any) => {
  const index = inMemoryTransactions.findIndex(tr => tr.transferid === transaction.transferid);
  if (index === -1) {
    throw new Error("Transaction not found");
  }
  inMemoryTransactions[index] = {
    ...inMemoryTransactions[index],
    ...transaction,
    updated: true,
  };
  return inMemoryTransactions[index];
};

export const deleteTransaction = async (id: string, userId: string) => {
  const index = inMemoryTransactions.findIndex(tr => tr.id === id);
  if (index === -1) {
    throw new Error("Transaction not found");
  }
  inMemoryTransactions.splice(index, 1);
  return {
    id,
    deleted: true,
    updatedby: userId,
  };
};

export const restoreTransaction = async (id: string, userId: string) => {
  return {
    id,
    restored: true,
    updatedby: userId,
  };
};
